---
title: "Analysis of Changes in the European Flights Record"
author: "Rosemary Nnamdi (S2244511)"
date: "2023-03-24"
output:
  html_document: default
  pdf_document: default
---

**Project Summary** 

The aim of this project is to analyze the European flights from 2016 to 2022 to analyze the trends that occurred. During this period, the European polity has witnessed changes like Brexit and COVID. In this visualization, different charts and graphs will be plotted using R to show the changes in flight records in different countries, airports and years.

It will also analyze the disparities that exist between the data supplied by Network Manager and Airport Operator, and their impacts on the analysis.



**Introduction**

This should include an introduction to the research topic and the dataset you've chosen as well as the research questions, or research objectives.

In the recent years, Europe has been faced with tremendous changes such as the COVID 19 pandemic and Brexit. Global activities grounded to a halt. There were restrictions in numerous countries, and most people had to stay home for a long time. Firms adopted remote working style.

In this report, we will analyze the impact of these changes like COVID 19 and Brexit on European flights. We will also analyze the country with the most flights and why.

* Background of Dataset

For this analysis, I am using the European flights data set that can be gotten from https://ansperformance.eu/data/. The data set is a csv file that shows the relationship between Year, Total Flights, Airports and Countries.

The European flights dataset was gotten from Eurocontrol, and the column names have the following descriptions.

YEAR: YEAR
MONTH_NUM: Month (numeric)
MONTH_MON: Month (3-letter code)
FLT_DATE: Date of flight
APT-ICAO: ICAO 4- letter airport designator
APT_NAME: Airport Name
STATE_NAME: Airport's country
FLT_DEP_1: Number of IFR Departures
FLT_ARR_1:Number of IFR Arrivals
FLT_TOT_1: Number total IFR movements
FLT_DEP_IFR_2: Number of IFR departures
FLT_ARR_IFR_2: 	Number of IFR arrivals
FLT_TOT_IFR_2: 	Number total IFR movements

It covers European flights from 2016 to 2022.

**Problem Statement** 

Firstly, it is done to explore the differences in the total flights pre- and post-covid. I want to see if the countries with high flights before COVID remain the same after covid.
Secondly, it will analyze the countries with the most flights, and why
Thirdly, did the Brexit affect the total number of flights happening in the UK?
Fourthly, which country has the highest number of airport, and do they have the highest number of flights?

After looking at the dataset, I noticed some disparities in the data given by Network Manager and Airport Operator. The departure flights, arrival flights and total flights from Network manager and Airport Operator are different. Why could this be?


**Methods**. Make sure to include a description of the characteristics of the variables of interest, and the data cleaning/wrangling steps used.

Typically, the steps I took involve:

* Installing necessary libraries and loading them. 

When I installed them, the first time, I removed them from my chunk of code as it was no longer needed.

The installations were done with:
install.packages("tidyverse")
install.packages("ggplot2")
install.packages("forcasts"), and
install.packages("dplyr").

I loaded the aforementioned libraries with: 

library(tidyverse)
library(ggplot2)
library(forcasts)
library(dplyr).


* Dataset Importation

The dataset I used was the European flights record from 2016 to 2022 in csv format.


* Dataset Exploration

In this stage, I intend to view the Flights.csv data set using the following:
1. str() function displays the R object's internal structure.
2. glimpse() function displays the columns of the flights data set and show a part of the data with their attributes.
3. head() function displays the first n rows present in the flights data set.
4. summary() function summarizes the values in the dataframe.
5. which(is.na()) to see if there are any missing values.

During the exploration of the data set, I realized that the figures submitted by the Airport operator differed from the figures entered by the Network Manager. The Airport Operator filled in the information in the FLT_DEP_IFR_2, FLT_ARR_IFR_2 and FLT_TOT_IFR_2, which had a lot of missing values.


* Data Preparation

The next step I did was data cleaning, which involves trying to fill the missing values. I attempted two methods. The first one is to remove rows that had missing values. After doing this, I realized that major of my data set had been eliminated, which would not give a representation of the data set.

The second method that I decided to opt for was the filling of missing values with means of the columns. I stuck with this method.


* Data Manipulation and visualization
The next step I took was to manipulate the data set and visualizing different aspects to solve my research problems, which are discussed in next section.
I used bar chart, scatterplot, histogram, Line Chart, Lollipop, Box Plot and Dot Plot.

** Bar Chart

The bar chart shows the relationship between one or two categorical variables using bars. 

** Scatterplot

Scatterplot shows the relationship that exists between two numerical variables.To plot a scatterplot, I used geom_point(). I used scatterplot because I wanted to find the extent of correlation between two variables.

** Histogram

It shows the distribution of one numerical variable. I used it because I wanted to conveniently show the major features of the distribution of a column in the data set.

** Line Chart

The line charts shows the relationship between two numerical variables, and it is meant to be used when there is a sequential order.

** Lollipop

Lollipop can be the linked to a barplot, except in its case, the where the bar is transformed in a line and a dot. I use them when I want to compare multiple categories or trends over time.


** Box Plot

Boxplots can be used in displaying the distributions of numeric data values. Typically, the box plot has four quartiles. Q1 is greater than 25% of the data, Q2 lies in the middle and it is the median, Q3 is greater than 75% of the data set, and Q$ is less than 25%.

One can denote the locations of Q1, Q2, and Q3 based on the ends of the box and center line mark.

Firstly, I will store the graph to use with box_plot.
Secondly, adding the geometric object of R boxplot()
To do this, the flights_new dataset is passed to the ggplot boxplot.
In the aes() argument, I am adding the y and x axes.
The addition sign is to ensure that R reads the code after it.
The geom_boxplot() is to create the boxplot.

** Dot Plot

Dot plot helped me visualize the  visualize the shape and spread of the selected data. It gave me more details and was efficient.


* Explanation of Results

Before we go any further, it is important to note that the dataset stopped in may 2022, and does not tell the complete story of the flight in 2022. This is a limitation to the analysis.

Country with the highest number of flights
In the visualization, I realized that Germany had the highest number of flights based on summing the FLT_TOT_1 column and plotting it against the names of country or STATE_NAME.

When I plotted the  countries against the FLT_TOT_IFR_2, France became the country with the highest flights. This is because the missing values in this column were filled with mean. It may also be because they had more IFR flights compared to other countries. 


I noticed that though France may have more airports than Germany, the total number of flights are second to the latter. This may be because Germany has more connecting flights. It may also be because France banned a EU short-haul flight ban. (The Guardian, 2021).

While exploring the Germany dataset, I decided to create a new dataset to make it easier to extract the columns and rows I needed, as well as plot graphs and charts.

During the analysis, it was realized that Frankfurt had the highest number of flights in Germany and most flights occurred in the month of May and the year 2019.

Germany has multiple large international airports like Frankfurt and Munich with a high frequency of connecting flights or transfers. This may be the reason for the high number of flights.

** COVID

Before the COVId, there was a slight increase in the number of flights annually. The year, 2019, had the highest number of flights, but the trend reduced when 2020 came along. 

It had total flight of 17185911, which dropped in 2020 to 7417016. It is not surprising because 2020 was the onset of the COVID pandemic, which unveiled global lockdown and travel restrictions.

At the moment, the flights frequency have increased, though no year after 2020 has been able to catchup with its predecessor, 2019.

The COVID pandemic led to a shut down of businesses and airlines were also affected. Countries instilled serious travel restrictions, which dropped the flights in 2020.

Before the COVID, which spanned from 2016 to 2019, United Kingdom had the highest flights coming and departing. This is based on a cumulative figure for four years, 2016 to 2019. 


When the COVID hit, Spain took over from UK in 2020 and 2021. This is not surprising because Spain had laxer travel guidelines unlike in the UK.

After the COVID (2022), Spain still ranks highly compared to other European countries. The Brexit may also be another reason that the UK slipped in record.


** BREXIT

The UK began the process to leave the European Union on On 29 March 2017, when it announced its intentions to the EU. It officially left on 23:00 GMT on 31 January 2020.(EUR-Lex, 2023).

From my analysis, I noticed a drop in the number of flights in 2020 when Brexit took and a sharper drop in 2021, which could be a combination of Brexit and the COVID pandemic. The Brexit negatively affected flights in the UK because it became more difficult for other Europeans to come into UK.


** Airport Operator vs Network Manager

The Network Manager provided complete records for the columns that they filled, which are the FLT_DEP_1, FLT_ARR_1 and FLT_TOT_1 had no missing values.

The Airport operator columns, which are the FLT_DEP_IFR_2, FLT_ARR_IFR_2 and FLT_TOT_IFR_2 had a lot of missing values.

IFR stands for those rules that govern aircrafts that are flying in IMC or  instrument meteorological conditions. This means those flights that occur in poor weather conditions. As a result of the poor weather conditions, the aircraft navigates using only the instruments in the cockpits. This may be the reason that columns with IFR attached to their names have missing values.

The network manager's input differed from the airport operator, as the latter had numerous missing values, which had to be filled with mean, especially for the total flights values.
This is the reason for the disparity between the country with the highest flights in FLT_TOT_1 and FLT_TOT_IFR_2. Another reason may be because those places with missing values did not have IFR flights or flights with poor weather conditions.

I opted for the figure supplied by the Network manager because it had no missing values, hence seems more reliable. From the data supplied, Germany had the most flights in contrast to what was supplied by the airport operator, which was France.

While, it is almost impossible to get a clean data set, the number of missing values were quite high. This affected the analysis as filling them with the mean value made France to have the highest number of flights as against Germany that had the highest flights based on the complete records from the Network Manager.

This is why in the analysis I opted for using the columns supplied by the Network Manager. 


** Airports with the Lowest and Highest Flights

During the analysis, it was noted that Amsterdam- Schipol was the airport with the highest flights, while Tukums Jurmala had the lowest flights. 

The Amsterdam - Schipol Airport is based in the Netherlands, and it was busiest from the range of 2016 to 2022 based on summing the FLT_TOT_1 and comparing it against APT_NAME. it is not surprising because this is the home base of many international airlines such as KLM, Amaterdam airlines, Transavia and so on. (Amsterdam Info, no date).

Tukums Jurmala airport is based in a small European country called Latvia. It is not surprising that the airport ranks the lowest in the total number of flights.



* Conclusion / Recommendation

COVID 
From the visualization, flights peaked in 2019, and it may have increased in 2020, if the trend is anything to go by, but the pandemic stopped that. In 2020, the total number of flights crashed, though there has been an increase in 2022. This is because most of the travel restrictions in European countries including the UK have been suspended.


Countries with the most flights
Germany had the most flights when the FLT_TOT_1 of 2016 to 2022 was used. When I used FLT_TOT_IFR_2, which was based on IFR flights, France ranked highly. Germany may be ontop because of the high connecting flights and being a commercial center.


Did countries with high flights before COVID remain the same after Covid?
UK had the highest number of flights before COVID.
Spain had the highest flights once the pandemic began may be because it had laxer travel restrictions. It is noteworthy that it still remains on top.
Other countries should put in place measures to attract more flights such as tourist attractions.


Did the Brexit affect the total number of flights happening in the UK?
Brexit affected the flights in the UK. I can notice a drop in the number of flights in 2020 when Brexit took and a sharper drop in 2021, which could be a combination of Brexit and the COVID pandemic.
The Brexit negatively affected the flights as EU citizens had restrictions to easily enter the UK, unlike before the exodus.



Which country has the highest number of airport, and do they have the highest number of flights?
The visualization and data exploration showed that Germany had more flights compared than other countries, not minding that France had the highest number of airports. This means that Germany should continue doing what it is doing to clinch the spot.

If we used the IFR, we can see that France had the highest flights happening in poor weather conditions.

For airports with lower flights, it is advisable to create more tourist spots to attract flights.


# Appendix

This shows the codes and the results in visualizing the flights.csv. I used the results to reach my conclusions.

## Load Library

For this analysis, I will use the tidyverse library. I installed and loaded the library. After installing it the first time, I removed the installing code chunk.

```{r}
library(tidyverse)
```

## Uploading the dataset

In this stage, I will retrieve the European flights data set from the csv file, and name it flights. I am importing a data set from a .csv file.

For this to work, I have to set my working directory.

Read.csv() allows me access the csv file.

In this stage, I am assigning the name 'flights' to the dataset. Henceforth, when I am interacting with this data set, I will use the name "flights", though this will change in some sections, where I extract some portion of the dataset to create anew one.

```{r}
flights <- read.csv("flights.csv")
```

## Viewing the data set

I want to take a peek at the European flights data set.
To do this, I will use the following:
* glimpse()
* head()
* str()

```{r}
# Taking a peek into the dataset.
glimpse(flights)
```

```{r}
head(flights)
```


I want to view the data type as well as the first rows of the dataframe.
```{r}
str(flights)
```
From the observations, I can see that it has 688099 observations and 15 dimensions that shed more light on the European flighst such as the date, departure and arrival airports and much more.

```{r}
#check if it is a dataframe or not
print(is.data.frame(flights))

# To view the number of columns and rows
print(ncol(flights))
print(nrow(flights))
```
The above shows that this is a dataframe and there are 15 columns and 688099 rows.


I want to extract the year column and find out the minimum and maximum values.
```{r}
year <- flights$YEAR
```


```{r}
min(year)
max(year)
```
The minimum year and maximum year in this dataset are 2016 and 2022 respectively.


## Viewing the quality of the data
I want to see if there are any missing values or outliers. To do this, I will use the following:

* summary() function
* sum(is.na()) function
* which(is.na()) function

```{r}
# To get key statistics of the dataset
summary(flights)
```
From the above, we can view the key statistics of the different columns such as their mean, median and mode. This shows that the FLT_DEP_IFR_2, FLT_ARR_IFR_2 and FLT_TOT_IFR_2 had missing values.


I want to check the total number of missing values exist in the dataset.
```{r}
sum(is.na(flights))
```

sum(is.na()) shows the total missing values, while summary () function shows those columns that have missing values.

from the above, we can see that there are 1439355 omitted entries. With the help of summary() function, we can see that the NA values are sited in the following columns: FLT_DEP_IFR_2, FLT_ARR_IFR_2 and FLT_TOT_IFR_2 .

## Preprocessing of flights dataset

### Fixing the columns
There are two ways that I can use to fix the missing values in the dataset.
* By removing rows that have missing values in the dataset.
* The second one is by filling the missing values with the mean of the column.

### Removing the missing rows
The na.omit() function can be used to remove the rows with missing values.
The select() function will be used to remove redundant columns, which are the X, and Pivot Label because they add no value to our analysis.
```{r}
flights_clean <- flights %>%
  na.omit() %>% 
  select(-X, -Pivot.Label)
```

# Checking if there is still any NA Value
```{r}
sum(is.na(flights_clean))
```
The above shows that there is no NA value in the new flights_clean dataset. This means that it worked.
```{r}
glimpse(flights_clean)
```
From the above, I can see that the rows with the NA values have been removed. The rows have dropped to 208,314.

### Filing missing values with mean
The second option is to fill the missing values with mean values.

There are three columns with missing values, which are flights$FLT_ARR_IFR_2, flights$FLT_TOT_IFR_2 and flights$FLT_DEP_IFR_2.

Filling the flights$FLT_ARR_IFR_2 missing values with mean.
The flights$column_header selects the columns in the flights dataset that is shown after the $ sign.

The is.na(flighst$column_header) returns true for every cell in the chosen columns with NA values.

The ave(flights$column_header,FUN = function(x) mean(x, na.rm = 'TRUE')) is meant to calculate the average or mean of the column.

```{r}
flights$FLT_ARR_IFR_2 = ifelse(is.na(flights$FLT_ARR_IFR_2), ave(flights$FLT_ARR_IFR_2, FUN = function(x) mean(x, na.rm = TRUE )), flights$FLT_ARR_IFR_2)
```

Filling the flights$FLT_TOT_IFR_2 missing values with mean.
```{r}
flights$FLT_TOT_IFR_2 = ifelse(is.na(flights$FLT_TOT_IFR_2), ave(flights$FLT_TOT_IFR_2, FUN = function(x) mean(x, na.rm = TRUE )), flights$FLT_TOT_IFR_2)
```

Filling the flights$FLT_DEP_IFR_2 missing values with mean.
```{r}
flights$FLT_DEP_IFR_2 = ifelse(is.na(flights$FLT_DEP_IFR_2), ave(flights$FLT_DEP_IFR_2, FUN = function(x) mean(x, na.rm = TRUE )), flights$FLT_DEP_IFR_2)
```
I want to check if there is any missing values after filling the three columns that had missing values with the mean.

```{r}
sum(is.na(flights))
```
From the above, we can see that there is no missing value in flights dataset. I will opt for the second method, which is filling missing values with mean. This is to ensure that the dataset does not lose a lot of its rows with missing values.


### Removing Unwanted Column
There are two columns that I feel are not necessary in the flights-new dataset, and they are the X and Pivot.Label columns.

```{r}
flights_new <- flights %>%
  select(-X, -Pivot.Label)
```

I want to check the new dataset, Flights_new.
```{r}
glimpse(flights_new)
```

```{r}
sum(is.na(flights_new))
```
From the above, we can see that the missing values have been replaced by their mean.




**Results (or Findings)**. Make sure to include at least 3 different types of data visualisations that address the research questions, and explain/justify your choice.


# Analysing the disparities of data from the Network Manager and Airport operator


1. Finding the state with the highest number of flights in 2016 to 2022 (Network Manager)

After exploring the European flights dataset, I realized that the missing values that existed were fed into the dataset by the Airport Operator. Apart from that, the data fed by airport Operator was for flights in poor weather conditions. 

This is why I prefer to get the state with the highest number of flights based on the data fed by the Network Manager, FLT_TOT_1. 

To do this, I am creating a new dataset, sumSTATE, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_TOT_1 column.

```{r}
sumSTATE <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))

sumSTATE
```
According to the network manager, Germany has the highest number of flights.


Finding the state with the highest number of flights in 2016 to 2022 (Airport Operator)

I want to find the country with the highest number of flights based on the FLT_TOT_IFR_2 created by the Airport Operator to see if they correspond with that of the Network Manager.

To do this, I am creating a new dataset, sumSTATE, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_TOT_IFR_2 column.
```{r}
sumSTATE <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(sum = sum(FLT_TOT_IFR_2))

sumSTATE
```
According to the Airport operator, France has the highest number of flights.
The disparity between both may be because of the NA values in the airport operator figures of FLT_TOT_IFR_2, and using mean to fill in the missing value. It may also be because it documents only IFR flights or flights that occurred in poor flight conditions.

For this analysis, I am more inclined to use the figure supplied by the network manager because of the absence of missing values.


2. Finding the state with the largest mean of departure flights in total (Network Manager)

To do this, I am creating a new dataset, meanSTATE, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_DEP_1 column.
```{r}
meanSTATE <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(mean = mean(FLT_DEP_1))

meanSTATE
```
Denmark has the largest mean of flight departure for the Network Manager's dataset of 285.
 

Finding the state with the largest mean of departure flights in total (Airport Operator)

To do this, I am creating a new dataset, meanSTATE1, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_DEP_IFR_2 column.
```{r}
meanSTATE1 <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(mean = mean(FLT_DEP_IFR_2))

meanSTATE1
```
Denmark has the highest mean of flight departure for the Airport Operator's dataset with 282.85523 or 283.


3. Finding the state with the largest median of arrival flights in total (Network Manager vs Airport Operator)

To do this, I am creating a new dataset, medianSTATE, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_ARR_1 column.

```{r}
medianSTATE <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(median = median(FLT_ARR_1))

medianSTATE
```
Denmark has the largest median of arrival flights with 327.


To do this, I am creating a new dataset, medianSTATE1, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_ARR_IFR_2 column.
```{r}
medianSTATE1 <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(median = median(FLT_ARR_IFR_2))

medianSTATE1
```
Denmark has the largest median of arrival flights with 327. 

4.  Finding the state with the largest average of total flights
To do this, I am creating a new dataset, meanSTATE_Total, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_TOT_1 column.

```{r}
meanSTATE_Total <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(mean = mean(FLT_TOT_1))

meanSTATE_Total
```
Denmark has the largest average of total flights ie summation of departure and arrival of 570 according to the network manager.


To do this, I am creating a new dataset, meanSTATE_Total1, and grouping the STATE_NAME with the group_by() function from the flights_new dataset, and summarizing it based on the sum of the FLT_TOT_IFR_2 column.
```{r}
meanSTATE_Total1 <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(mean = mean(FLT_TOT_IFR_2))

meanSTATE_Total1
```

Denmark has the largest average of total flights ie summation of departure and arrival of 566 according to the airport operator.

There may be disparities between the data from Network Manager and Airport Operator because:
* There are missing values, and these values were fixed using the mean.

* Secondly, for those that were not NA, some had disparity between the figures, which may be because IFR flights occurred during the poor conditions.

* It was noticed that the major disparity was reflected in the country with the highest flights. The data supplied by the Network Manager showed that Germany had the highest number of flights, while France was the highest based on the data from the airport operator. This disparity could affect the structure of one's analysis.


#Visualizing Distributions

1. Plotting the country with the highest flights


* Using Lollipop Chart
I want to plot the country with the highest flights using Lollipop. The lollipop chart is being used because there are a large number of values and their values are all high.


I will plot a lollipop based on the sum column, which would affect the width of the lollipop.


I will start by assigning the name (Highest), and group the STATE_NAME together with the group_by() function before summarizing based on the sum of the FLT_TOT_1 column.

```{r}
Highest <-
  flights_new %>%
  group_by(STATE_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))
```


I want to plot the Highest dataset based on the STATE_NAME AND sum column. I am assigning the title, Lollipop chart and subtitle to the lollipop chart.
```{r}
ggplot(Highest, aes(x=STATE_NAME, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=STATE_NAME, 
                   xend=STATE_NAME, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="COUNTRY vs Total Flights") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```
From the above, we can see Germany has the highest total number of flights.

* Using Bar cahrt
The abovementioned can also be visualized with a histogram as below.
In this case, I assigned the name p to the ggplot() instruction to plot the graph. The second line plots the STATE_NAME column against the identity statistics. 

theme(axis.text.x()) makes the countries in the x-axis vertical to make it more readable.

```{r}
p<-ggplot(data=flights_new, aes(x=STATE_NAME, y=FLT_TOT_1)) +
  geom_bar(stat="identity") + 
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank()) +
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
p
```


* Using boxplots

The theme(axis.text.x = element_text(angle=65, vjust=0.6)) is to slant the values in the x-axis to a 65 degree.

```{r}
ggplot(data = flights_new,
 mapping = aes(x = STATE_NAME,
 y = FLT_TOT_1)) +
 geom_boxplot() +
   theme(axis.text.x = element_text(angle=65, vjust=0.6))
```


 * Using violin plots

The difference between violin plot and box plot is that the former shows the full distribution of the data, while latter is used to get the summary statistics such as median and interquartile ranges.

```{r}
ggplot(data = flights_new,
 mapping = aes(x = STATE_NAME,
 y = FLT_TOT_1)) +
 geom_violin() +
   theme(axis.text.x = element_text(angle=65, vjust=0.6))

```


2. Exploring the Airport Column

* Plotting the airport with the largest flights.

In this case, I will load the dplyr library because I want to use the %>% operator.

```{r}
library("dplyr")
```

I want to check the airport with the highest flights
To do this, I will create a new dataset called sumAIRPORT, and group the APT_NAME together with the group_by() function before summarizing based on the sum of the FLT_TOT_1 column.. 

```{r}
sumAIRPORT <-
  flights_new %>%
  group_by(APT_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))
```

I want to arrange the airports based on descending order to make it easier to get the airport with the highest flights without having to scroll through the rows of results.

This can be done by using the order() function to rank the sum column based on decreasing order.

```{r}
sumAIRPORT[order(sumAIRPORT$sum, decreasing = TRUE),]  
```
From the above, we can see that Amsterdam - Schiphol airport has the highest number of flights. It is not surprising that the Amsterdam airport has the highest number of flights because it has direct connectivity. Hundreds of destinations can be reached from the airport and it allows connecting flights and transfers. (Schipol, no date).


I want to plot this information, hence I decided to assign a new name to the formed dataset called highestAIPORT.
```{r}
highestAIRPORT <- sumAIRPORT[order(sumAIRPORT$sum, decreasing = TRUE),] 

highestAIRPORT
```


I am visualizing this dataset with a barplot and asking that it be plotted based on the top five airports.

```{r}
barplot(highestAIRPORT$sum[1:5],names.arg=highestAIRPORT$APT_NAME[1:5]) 
```


* Airports with the lowest flights
I want to plot the airports with the lowest flights, and to do this, I will first assign the name lowestFlights and ask that the sumAIRPORT data be arranged based on the sum column in increasing order.

```{r}

lowestFLIGHTS <- arrange(sumAIRPORT, sum)

lowestFLIGHTS
```

From the above, I can see that Tukums Jurmala has the lowest flights in Europe. 
Tukums Jurmala is an airport in a small European country called Latvia that barely attracts as much visitors as other countries.



```{r}
barplot(lowestFLIGHTS$sum[1:5],names.arg=lowestFLIGHTS$APT_NAME[1:5]) +
   theme(axis.text.x = element_text(angle=65, vjust=0.6))
```



3. Exploring the Year Column


* Based on FLT_TOT_1 column
I want to see the year that has the highest number of flights as opposed to the year with the lowest number of flights.

To do this, I will compare the year column to the sum of the FLT_TOT_1 to know which year had the highest number of flights.
I will group the Year together with the group_by function and summarize the FLT_TOT_1 column by the sum.

```{r}
sumYEAR <-
  flights_new %>%
  group_by(YEAR) %>%
  summarize(sum = sum(FLT_TOT_1))

sumYEAR
```
2019 has the highest number of flights.


* Based on count
I also want to rank the year column using count

```{r}
flights_new %>%
  count(YEAR)
```

2019, from above, has the highest number of flights by count. We can see that from the two above tables, the figures for each year differs because the first table is ranked considering the total flights column, while the second table was ranked based on the count of the Year column.
I prefer to use the sum of FLT_TOT_1 column in my analysis than rely on count.


* Based on FLT_TOT_1 column visualization
I want to use bar chart to plot the year distribution to show the segments of information, especially since it is time-series data.
To do this, I am assigning the ggplot() instruction to p, and fill it in with the green colour. I am assigning the chart a title.

```{r}
p<-ggplot(data=flights_new, aes(x=YEAR, y=FLT_TOT_1)) +
  geom_bar(stat = "identity", fill = "green") + labs(title = "Total Number of Flights Per Year")
p
```
From the above, 2019 has the highest number of flights, and if you look at the bars from 2016 to 2019, it is easy to see an upward trend, which was cut short in 2020. This may be linked to the COVID pandemic in 2020 that led to flight restrictions.


* Based on count visualization using bar chart
I want to plot the Count or Frequency of Year. As part of the code, I am using the theme to remove the background to give the bar chart a cleaner look.
```{r}
ggplot(data = flights_new) +
  geom_bar(mapping = aes(x =YEAR)) +
  theme(panel.grid.major.x = element_blank(),
        legend.position = "bottom") +
  theme_bw() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank())
```
From the above, we can see that the number of flights peaked at 2019. One can spot the disparities between bars plotted by FLT_TOT_1 and count. This is a disadvantage of using count instead of the FLT_TOT_1 column.


* Based on count visualization using density plot
I want to visualize the distribution of Year using density plot because I want a clearer picture of the distribution.

I am using the alpha argument to change the transparency level of the fill color to ensure that the colors in the distribution do not overlap.

I changed the opacity (alpha) of geom elements on the plot to cover the entire plot and not a single variable. This is why it was not mapped in the aes().

```{r}
flights_new %>%
  ggplot(aes(x=YEAR)) +
    geom_density(fill="#69b3a2", color="#e9ecef", alpha=0.8)
```

4. Exploring the Differing Figures By Network Manager and Airport Operator
I want to explore the differences between the data supplied by the Network Manager and Airport Operator in FLT_TOT_1 and FLT_TOT_IFR_2 respectively. Like earlier noted, the FLT_TOT_1 captures the total flights happening in Europe, while the FLT_TOT_IFR_2 captures the total IFR flights that occurred in poor weather conditions.

I want to compare year to the different figures they submitted as total flights.


* Using Dotplot to Visualize Year (Network Manager)
I used a dotplot because I wanted to visualize a smaller set of data. I also decided not to remove the background because it becomes difficult to read.

To begin, I will create a new dataset called HighestYear, and group the YEAR column, then summarize it based on the sum of FLT_TOT_1. As earlier mentioned, I am using FLT_TOT_1 of Network Manager.

```{r}
HighestYear <-
  flights_new %>%
  group_by(YEAR) %>%
  summarize(sum = sum(FLT_TOT_1))

HighestYear
```
For the Network Manager data, we can see that 2019 had the highest number of flights.

Plotting the year against sum with dotplot.
```{r}
ggplot(HighestYear, aes(x = sum, y = YEAR))+ geom_point() 
```

Using Lollipop plot to compare year to total flights or sum (Airport Operator)

```{r}
TotalYear <-
  flights_new %>%
  group_by(YEAR) %>%
  summarize(sum = sum(FLT_TOT_IFR_2))

TotalYear
```
For the airport operator data, we can see that 2019 had the highest number of flights.

```{r}
ggplot(TotalYear, aes(x=YEAR, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=YEAR, 
                   xend=YEAR, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="Year vs Total Flights (Network Manager)") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```


I want to explore the relationship between total number of flights documented by network manager (FLT_TOT_1) and airport operator (FLT_TOT_IFR_2) with a 2D DENSITY PLOT.

I chose 2D  density plot or scatterplot because it studies the relationship between two numerical variables, which are the total flights according to a network manager and an airport operator.

```{r}
ggplot(flights_new, aes(x=FLT_TOT_1, y=FLT_TOT_IFR_2) ) +
  geom_point()
```

From the above, we can see that there is a strong correlation or relationship between the two variables, FLT_TOT_1 and FLT_TOT_IFR_2 because the data points are close enough to form a straight line when plotted.



I want to compare total number of flights of Network Manager and Airport Operator against year.
To do this, I will split them into different years to get a better view of which year has the highest correlation. I want to use scatterplot with facet_wrap. Facet_wrap() function shows individual categories (YEAR) in their own graph.

```{r}
ggplot(data = flights_new, mapping = aes(x = FLT_TOT_IFR_2, y = FLT_TOT_1, colour=YEAR)) + 
  facet_wrap(~YEAR, ncol =2) +
  geom_point()
```

In 2020, we can see that there is a strong correlation or relationship between the two variables, FLT_TOT_1 and FLT_TOT_IFR_2 because the data points are close enough to form a straight line when plotted.


5. Exploring country with the most flight, Germany.

Germany has the most flights. I want to see which YEAR Germany had the highest number of flights. (Line Chart)
I want to plot the total flights data for the years 2016 until 2022, for Germany

To do this, I am filtering the data for Germany row, and naming the new dataset, dataFiltered.

```{r}
dataFiltered <- filter(flights_new, STATE_NAME %in% c("Germany"))

```

I want to view the dataFiltered data.
```{r}
glimpse(dataFiltered)
```


* Visualize total flights in Germany across months
I want to load the forcats library, then plot the Month against the total flights.The coord_flip is to flip the bars horizontally.

```{r}
library(forcats)

dataFiltered %>%
  mutate(name = fct_reorder(MONTH_MON, FLT_TOT_1)) %>%
  ggplot( aes(x=MONTH_MON, y=FLT_TOT_1)) +
    geom_bar(stat="identity", fill="#f68060", alpha=.6, width=.4) +
    coord_flip() +
    theme_bw()
```

Germany has more flights in the month of May.


* Visualize total flights in Germany across Years
To start, I will create a data set called GermanyTotal to allow me plot Year against total flights in Germany.

```{r}
GermanyTotal <-
  dataFiltered %>%
  group_by(YEAR) %>%
  summarize(sum = sum(FLT_TOT_1))

GermanyTotal
```

Germany had the most flights in 2018. The difference between 2019 and 2019 is barely over a thousand.


I want to rename the sum column as Total_Flights

```{r}
GermanyTotal <- rename(GermanyTotal, Total_Flights = sum)
```



I am using a lollipop chart because it conveys similar information as bar chart and reduces the thick bars into thin lines, making it easier to understand. The plot is made from the GermanyTotal dataset.

```{r}
ggplot(GermanyTotal, aes(x=YEAR, y=Total_Flights)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=YEAR, 
                   xend=YEAR, 
                   y=0, 
                   yend=Total_Flights)) + 
  labs(title="Lollipop Chart", 
       subtitle="YEAR VS TOTAL FLIGHTS IN GERMANY") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```
The above concludes that Germany had the most flights in 2018 compared to other years.


I want the lines to be grey. The theme_light is to turn the line light. I want the dot ontop of the lollipop to be orange.
```{r}
ggplot(GermanyTotal, aes(x=YEAR, y=Total_Flights)) +
  geom_segment( aes(x=YEAR, xend=YEAR, y=750, yend=Total_Flights), color="grey") +
  geom_point( color="orange", size=3) +
  labs(title="Lollipop Chart", 
       subtitle="YEAR VS TOTAL FLIGHTS IN GERMANY") +
  theme_light() +
  theme(
    panel.grid.major.x = element_blank(),
    panel.border = element_blank(),
    axis.ticks.x = element_blank())
```


* What Airport In Germany had the highest flights?


### Using Lollipop
I want to find the busiest airport in Germany, and see the reason that is the case. I have decided not to plot this by creating a new dataset and plotting the APT_NAME against by sum because I want to display the way a lollipop chart will look without it.

```{r}
ggplot(dataFiltered, aes(x=APT_NAME, y=FLT_TOT_1)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=APT_NAME, 
                   xend=APT_NAME, 
                   y=0, 
                   yend=FLT_TOT_1)) + 
  labs(title="Lollipop Chart", 
       subtitle="GERMAN AIRPORT VS TOTAL FLIGHTS IN GERMANY") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```
Frankfurt has the highest number of flights. This is not surprising as Frankfurt has a lot of connecting flights to other parts of Europe and the world.


### Using Dot Plot
Dot Plot bears some similarities with line plots, except that it is flipped to horizontal position.


I want to create a new data set called GermanySum to easily plot the dot plot.
```{r}
GermanySum <-
  dataFiltered %>%
  group_by(APT_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))

GermanySum
```

I want to rename the sum column as Total Flights
```{r}
GermanySum <- rename(GermanySum, Total_Flights = sum)
```


```{r}
ggplot(GermanySum, aes(x=APT_NAME, y=Total_Flights)) + 
  geom_point(col="tomato2", size=3) +   # Draw points
  geom_segment(aes(x=APT_NAME, 
                   xend=APT_NAME, 
                   y=min(Total_Flights), 
                   yend=max(Total_Flights)), 
               linetype="dashed", 
               size=0.1) +   # Draw dashed lines
  labs(title="Dot Plot", 
       subtitle="German Airport Vs Total Flights") +  
  coord_flip()
```
Frankfurt has the highest number of flights in Germany. This corresponds with what is obtainable in the lollipop above.


* Comparing the two largest airports in Germany: Frankfurt and Munich
To do this, I want to convert the FLT_DATE to date format, and assign it to a new name, df.

```{r}
df <- dataFiltered %>% 
  mutate(year = as.Date(paste(FLT_DATE, "-01-01", sep = "", format='%Y-%m-%d')))
```


Here, I want to extract Frankfurt and Munich from the APT_NAME and assign it to df.Then, I want to convert the FLT_DATE to date format, and assign it to a new name, df.
```{r}
df <- dataFiltered %>% 
  filter(APT_NAME %in% c("Frankfurt", "Munich")) %>% 
  mutate(year = as.Date(paste(FLT_DATE, "-01-01", sep = "", format='%Y-%m-%d')))
```


```{r}
df %>% ggplot(aes(x = YEAR, y = FLT_TOT_1, fill = APT_NAME)) + geom_bar (stat = "identity") + ggtitle ("Frankfurt vs Munich")
```

Over the years, Frankfurt has always had more flights than Munich and this may be because the former connects more flights across the globe.

The flights that came through Frankfurt and Munich reduced from 2020, and this can be linked to the COVID and probably Brexit.


* Does Germany have the highest number of airports?

```{r}
airport_frequency <- aggregate(APT_NAME ~ STATE_NAME, flights_new, function(x) length(unique(x)))

print(airport_frequency)
```


One may expect that the country with the highest number of flights should have the highest number of airports, but that is not the case. France has 63 and Germany has 16 airports. This is weird, as German airports have far more flights. 

It is surprising that France has the highest number of airports, while Germany has the highest number of flights when the sum is done based on FLT_TOT_1. When the analysis of the country with the highest number of flights is done with the mean-filled FLT_TOT_IFR2, France ranks the highest in terms of flights.

When I analyze the CSV files, I can see that France may have more entries to different airports under the FLT_TOT_1 column, but Germany has more figures for its fewer airports. 
Another reason may be because the FLT_TOT_IFR_2 contain only IFR flights.
The third reason may be because many connecting flights happen in Germany.


6. Exploring Brexit and its effects on flights

The decision by the United Kingdom to leave the European Union came with multiple efefcts on the economy. I want to explore its effects on flights.
Brexit officially took effect on the 31 January 2020 at 11:00pm GMT. In this analysis, from 2016 to 2019 will be viewed as before Brexit and the rest after Brexit.


Exploring flights before and after the Brexit in the United Kingdom

I want to create the Brexit Data set, which filters the UK's data from the general flights.csv data.
```{r}
BrexitData <- filter(flights_new, STATE_NAME %in% c("United Kingdom"))
```

I want to take a look at the Brexit dataset.
```{r}
glimpse(BrexitData)
```

* Comparing the flights in the United Kingdom before and after Brexit.
I intend to compare the flights that happened in the UK before and after the Brexit to see if there was any changes.

To do the visualization, I have decided to create a new dataset called BrexitTotal based on the Year and FLT_TOT_1 of UK.

```{r}
BrexitTotal <-
  BrexitData %>%
  group_by(YEAR) %>%
  summarize(sum = sum(FLT_TOT_1))
BrexitTotal
```
UK had the highest flights in 2018.

```{r}
ggplot(BrexitTotal, aes(x=YEAR, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=YEAR, 
                   xend=YEAR, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="TOTAL FLIGHTS IN UNITED KINGDOM 2016-2022") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```

From above, I can notice a drop in the number of flights in 2020 when Brexit took and a sharper drop in 2021, which could be a combination of Brexit and the COVID pandemic.


### Visualizing flights in the UK across different years and airports.
I want to explore the flights that occurred in Uk airports across different years.

```{r}
BrexitData %>% ggplot(aes(x = YEAR, y = FLT_TOT_1, fill = APT_NAME)) + geom_bar (stat = "identity")
```
From the above, we can see that Heathrow Airport in London continued to dominate the rank of the airport with the highest flights in the United Kingdom. Its flights dropped after the Brexit, but it is important to note that there was still a pandemic happening during that period. This may have also affected the flights happening in UK airports.

Another core feature that can be noted is that airports in London had the highest number of flights compared to other regions in the UK. This may be because of the busy nature of the city and commercial capacity.


### Airport in the UK with highest flights using Dot Plot.
I want to a clearer look of the airport with the highest flights, hence I am using the Dot Plot.

```{r}
BrexitAPT <-
  BrexitData %>%
  group_by(APT_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))
```


```{r}
ggplot(BrexitAPT, aes(x=APT_NAME, y=sum)) + 
  geom_point(col="tomato2", size=3) +   # Draw points
  geom_segment(aes(x=APT_NAME, 
                   xend=APT_NAME, 
                   y=min(sum), 
                   yend=max(sum)), 
               linetype="dashed", 
               size=0.1) +   # Draw dashed lines
  labs(title="Dot Plot", 
       subtitle="Airport Vs Total Flights") +  
  coord_flip()
```

London (Heathrow) airport has more flights than other airports in the UK.



7. Exploring COVID's Effects on Flights
In this analysis, 2016 to 2019 is the pre-COVID period, while 2020-2021 is the COVID period, and 2022 is post-COVID.

I want to compare Year against count to see what year that flights dropped. To do this, I will use bar chart.

```{r}
ggplot(data = flights_new) +
  geom_bar(mapping = aes(x =YEAR))
```

When we use count to compare, it can be seen that flights dropped in 2020.




### A. Comparing Pre- COVID Years
I want to compare the travel flights in the years before the COVID. To do this, I am fiiltering the years from 2016 to 2019, and assigning them to PreCOVIDdata.
```{r}
PreCOVIDdata <- filter(flights_new, YEAR %in% c("2016", "2017", "2018", "2019"))
```

```{r}
glimpse(PreCOVIDdata)
```

### Country with the highest flights in PreCOVID Years

I want to see the country that had the highest number of flights before the COVID.

```{r}
PrecovidSum <-
  PreCOVIDdata %>%
  group_by(STATE_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))
```

I want to arrange the PrecovidSum data to descending order to see the country with the highest flight before Covid. 
```{r}
PrecovidSum[order(PrecovidSum$sum, decreasing = TRUE),] 
```

I can see that United Kingdom had more flights before the onset of COVID. 

```{r}
ggplot(PrecovidSum, aes(x=STATE_NAME, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=STATE_NAME, 
                   xend=STATE_NAME, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="Pre-COVID: COUNTRY vs Total Flights") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```

United Kingdom has the highest number of flights before COVID.



### B. Comparing COVID Years
In this analysis, I will take the COVID years as 2020 and 2021. To do this, I will create a new dataset valled COVIDdata and filter it based on the years 2020 and 2021.

```{r}
COVIDdata <- filter(flights_new, YEAR %in% c("2020", "2021"))
```


### Country with the highest flights during the COVID years
To do this, I intend to create a new dataset called the CovidSum, which I will use to tell the country with the highest during the COVID.
I will start by grouping it by STATE_NAME, then comparing it against the sum of the total flights column.

```{r}
CovidSum <-
  COVIDdata %>%
  group_by(STATE_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))
```

I want to arrange the CovidSum data set based on decreasing order of the sum column.
```{r}
CovidSum[order(CovidSum$sum, decreasing = TRUE),] 
```

During the Covid years of 2020 and 2021, Spain had more flights than other countries. This may be because of its laxer travel restrictions during the COVID years compared to similar countries in Europe.
According to deeper research, it was seen that the UK and some other countries placed Spain as a relatively safe destination for holiday goers during the summer of 2021.

### Explore the Spain dataset
To get more insight, I want to extract the Spain dataset to get a better look at when flights to and from Spain peaked.

```{r}
SpainData <- filter(flights_new, STATE_NAME %in% c("Spain"))
```

```{r}
glimpse(SpainData)
```

* Looking at the Spain data against the total flights and Year
```{r}
SpainSum <-
  SpainData %>%
  group_by(YEAR) %>%
  summarize(sum = sum(FLT_TOT_1))

SpainSum
```

I can see that Spain in 2019 had the highest flights, and it dropped in 2020, and increased in 2021. This may be because of the later travel restrictions in summer of 2021 for holiday goers.
 
The figure dropped in 2022 when the world started opening its borders.

```{r}
ggplot(SpainSum, aes(x=YEAR, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=YEAR, 
                   xend=YEAR, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="TOTAL FLIGHTS IN Spain 2016-2022") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```
I can see from above using the lollipop graph that the flights peaked in 2021 after falling in 2020.


* Plotting the Year against Count (Spain)
I want to convert the year column in the SpainData to date type, and call it df.

```{r}
df <- SpainData %>% 
  mutate(year = as.Date(paste(FLT_DATE, "-01-01", sep = "", format='%Y-%m-%d')))
```


```{r}
ggplot(df, aes(x=YEAR)) +
  geom_histogram( binwidth=1, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
  ggtitle("Comparing Year to Count") +
  theme_gray() +
  theme(plot.title = element_text(size=15)
    )
```

I want to plot Year against count but this time, use  theme_bw() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank()) to remove the background shadow to give it a cleaner look.
```{r}
ggplot(df, aes(x=YEAR)) +
  geom_histogram( binwidth=1, fill="#69b3a2", color="#e9ecef", alpha=0.9) +
  ggtitle("Comparing Year to Count") +
  theme_gray() +
  theme(plot.title = element_text(size=15)
    ) +
  theme(panel.grid.major.x = element_blank(),
        legend.position = "bottom") +
  theme_bw() +
  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(), panel.border = element_blank())
```
The count tells similar story to the FLT_TOT_1.


* Plotting the Year against Total Flights using Boxplot (Spain)

I want to convert the Year column from integer to character to allow me plot the boxplot because function works with character and not integer.
```{r}
SpainData$YEAR <- as.character(SpainData$YEAR)
```



```{r}
SpainData %>%
  mutate(YEAR = fct_reorder(YEAR, FLT_TOT_1, .fun='sum' )) %>%
  ggplot( aes(x=YEAR, y=FLT_TOT_1, fill=YEAR)) + 
    geom_boxplot() +
    xlab("YEAR") +
    theme(legend.position="none") +
    xlab("") +
    xlab("")
```


### C. Comparing Post-COVID Year
I want to extract the year 2022 and its associated data and name it a new data called PostCOVIDdata. The limitation to this aspect is that the flights_csv file does not contain the entire flights for 2022, as it sopped in May. 
```{r}
PostCOVIDdata <- filter(flights_new, YEAR %in% c("2022"))
```

I want to compare countries with their associated total flights during 2022, and to do this, I will group it by the state name and compare it with the sum of FLT_TOT_1.

```{r}
PostCovidSum <-
  PostCOVIDdata %>%
  group_by(STATE_NAME) %>%
  summarize(sum = sum(FLT_TOT_1))
```

I want to arrange them in decreasing order to see the country with the highest flight in year 2022.

```{r}
PostCovidSum[order(PostCovidSum$sum, decreasing = TRUE),] 
```
Spain had the highest flights during the first five months of 2022, meaning that it kept the first spot that it had during the COVID period.


```{r}
ggplot(PostCovidSum, aes(x=STATE_NAME, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=STATE_NAME, 
                   xend=STATE_NAME, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="POST-COVID") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```



Did the country with the highest flights before COVID remain the same?
No, UK had the highest number of flights before COVID, followed by Germany. Once the COVID hit, Spain had the highest flights, and retained the first position in the first five months of 2022 after the COVID.


### D. What month during the COVID period did flights peak?

```{r}
CovidMonths <-
  COVIDdata %>%
  group_by(MONTH_MON) %>%
  summarize(sum = sum(FLT_TOT_1))

CovidMonths
```

* Using lollipop
```{r}
ggplot(CovidMonths, aes(x=MONTH_MON, y=sum)) + 
  geom_point(size=3) + 
  geom_segment(aes(x=MONTH_MON, 
                   xend=MONTH_MON, 
                   y=0, 
                   yend=sum)) + 
  labs(title="Lollipop Chart", 
       subtitle="TOTAL FLIGHTS 2020-2021") + 
  theme(axis.text.x = element_text(angle=65, vjust=0.6))
```

The month of August had the most flights during the COVID years. This corroborates what the Europa article says about the data set.


* Using bar chart
```{r}
ggplot(COVIDdata, aes(x=MONTH_MON, y=FLT_TOT_1)) + 
  geom_bar(stat = "identity", width= 0.8)
```
The bar chart corresponds with what the lollipop states.


### E. What year during the COVID period did flights pick up?
Comparing between 2020 and 2021 which year had the highest flights. I am doing this because I want to know the year that flights picked up when the COVID started.

Before I begin, I want to convert the year column into character to avoid the histogram from plotting the year in decimal points.

```{r}
COVIDdata$YEAR <- as.character(COVIDdata$YEAR)
```


The coord_flip() is to make the barplot horizontal.
```{r}
ggplot(COVIDdata, aes(x=YEAR, y=FLT_TOT_1)) + 
  geom_bar(stat = "identity", width= 0.8) +
  coord_flip()
```
The total flights increased in 2021 after some countries started reducing their travel restrictions.



### F. When the flights start to peak in 2021?
I want to know when the flights peaked in 2021 against 2022. To do this, I am creating a new dataset called newdata, and filtering the years, 2021 and 2022 from the flights_new dataset.

I want to create a new column called MY.
```{r}
flights_new$MY <- paste(flights_new$MONTH_MON, flights_new$YEAR)
```


```{r}
newdata <- filter(flights_new, YEAR %in% c("2021", "2022"))
```

```{r}
glimpse(newdata)
```

```{r}
ggplot(newdata, aes(x=MY, y=FLT_TOT_1)) + 
  geom_bar(stat = "identity", width= 0.8) +
  coord_flip()
```
May 2022 was the month with the highest total flights after the pandemic began. August 2021 was the month the flights peaked in 2021.



This code is to knit the code into pdf.
```{r}
tinytex::install_tinytex(TRUE)
```






**Reference**
Amsterdam Airport Info (no date) Amsterdam Airport (AMS). Available at: https://www.amsterdamairport.info/

EUR-Lex (2023) Brexit: EU-UK relationship. Avaialable at: https://eur-lex.europa.eu/content/news/Brexit-UK-withdrawal-from-the-eu.html


Geek for Geek (2021) Filter multiple values on a string column in R using Dplyr
https://www.geeksforgeeks.org/filter-multiple-values-on-a-string-column-in-r-using-dplyr/

R: Challenge of 100+ Visualization in R
https://www.kaggle.com/code/saife245/r-challenge-of-100-visualization-in-r/notebook

R Graph (no date) The R Graph Gallery. Available at: https://r-graph-gallery.com/ 

Schipol (no date) Competitive position Schiphol. Available at: https://www.schiphol.nl/en/advertising/page/the-world-s-2nd-largest-hub-airport/#:~:text=Direct%20connectivity,contributes%20to%20its%20competitive%20power

The Guardian (2021) France to ban some domestic flights where train available. Available at: https://www.theguardian.com/business/2021/apr/12/france-ban-some-domestic-flights-train-available-macron-climate-convention-mps

Tutorialspoint (no date) How to create barplot for some top values in an R data frame? Available at: https://www.tutorialspoint.com/how-to-create-barplot-for-some-top-values-in-an-r-data-frame

How to create barplot for some top values in an R data frame?